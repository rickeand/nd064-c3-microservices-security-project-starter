Docker Threat Modeling
Given Docker's system components and the STRIDE framework, identify five potential threats that may arise.

1. Spoofing - There might be malicious images in the container layer which could expose the system to risk.

2. Tampering - If not properly configured, the docker client could be accessed and used to download malicious images.

3. Repudiation - If an attacker gets access to the docker client, it could lead to modified dockerfiles.

4. Denial of Service - If no memory limit is set, an attacker could cause the host machine to run out of memory.

5. Elevation of Privilege - when a Dockerfile does not specify a user, it defaults to executing the container using the root user, affecting client authorization and the Dockerfile.


Kubernetes Threat Modeling
Given Kubernetes' system components and the STRIDE framework, identify five potential threats that may arise.

1. Tampering - Without proper configuration etcd could be compromissed by an attacker.

2. Repudiation - An attacker could access the api server and make unauthorized changes.

3. Information Disclosure - Sensitive information could be exposed via the etcd key-value store.

4. Denial of Service - The api server could be overwhelmed by too much traffic.

5. Elevation of Privilege - Privilege can be abused by using the privileged flag. This should be avoided in all cases. This affects kube-apiserver.


Docker-bench Run Results and Analysis
From the failed findings, select and document 3 findings from the Docker-bench results that you want to harden based on the 5 attack surface areas you identified in Step 1. At least 1 of the 3 hardened findings should be different from the ones mentioned in the exercise (i.e. 5.10, 5.14, and 5.22).

[FAIL] 2.2 Ensure network traffic is restricted between containers on the default bridge (Automated)

- Denial of Service: [FAIL] 5.11 Ensure that CPU priority is set appropriately on container (Automated)
  Solution: use --cpu-shares flag to distribute resources to the containers according to their priority
  Example: docker run --interactive --tty --cpu-shares 512 centos /bin/bash

- Spoofing [FAIL] [FAIL] 4.5 Ensure Content trust for Docker is Enabled (Automated)
  Solution:
  Example:

- Elevation of Privilege [FAIL] 5.25 Ensure that the container is restricted from acquiring additional privileges (Automated)
  Solution: Add 'no-new-privileges' to the security options
  Example: docker run --rm -it --security-opt=no-new-privileges ubuntu bash

